webpackJsonp([3,15],{230:function(e,t,o){t=e.exports=o(5)(),t.push([e.id,"input[type=file]{display:none}.el-dialog{width:50%}.v-modal{display:none}.el-tabs__new-tab{float:left}.el-tabs__content{padding-left:20px}.el-form{background-color:#fff;padding:50px;width:70rem}.el-input__inner{border-style:solid;border-radius:4px;border:1px solid #bfd9cc}","",{version:3,sources:["/./src/pages/dns/dns_file.vue"],names:[],mappings:"AACA,iBACE,YAAc,CACf,AACD,WACE,SAAW,CACZ,AACD,SACE,YAAc,CACf,AACD,kBACE,UAAY,CACb,AACD,kBACE,iBAAmB,CACpB,AACD,SACE,sBAAwB,AACxB,aAAc,AACd,WAAa,CAEd,AACD,iBACE,mBAAoB,AACpB,kBAAmB,AACnB,wBAAqC,CACtC",file:"dns_file.vue",sourcesContent:['\ninput[type="file"] {\n  display: none;\n}\n.el-dialog {\n  width: 50%;\n}\n.v-modal {\n  display: none;\n}\n.el-tabs__new-tab {\n  float: left;\n}\n.el-tabs__content {\n  padding-left: 20px;\n}\n.el-form {\n  background-color: white;\n  padding: 50px;\n  width: 70rem;\n  /*border: 1px solid rgb(191, 217, 204);*/\n}\n.el-input__inner {\n  border-style: solid;\n  border-radius: 4px;\n  border: 1px solid rgb(191, 217, 204);\n}\n'],sourceRoot:"webpack://"}])},246:function(e,t,o){var s=o(230);"string"==typeof s&&(s=[[e.id,s,""]]);o(6)(s,{});s.locals&&(e.exports=s.locals)},306:function(e,t,o){o(246);var s=o(2)(o(390),o(337),null,null);e.exports=s.exports},337:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("hs-layout_auto",[o("div",{staticStyle:{"padding-top":"50px"}},[o("el-card",{staticClass:"box-card",staticStyle:{width:"100%"}},[o("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[o("span",{staticStyle:{color:"#149C4C","font-weight":"700","font-size":"16px"}},[e._v("\n            当前文件\n          ")])]),e._v(" "),e._l(e.res_data,function(t){return o("el-collapse",[o("el-row",[o("el-col",{attrs:{span:10}},[o("div",{staticStyle:{"padding-top":"15px","padding-left":"15px"}},[o("span",{staticStyle:{color:"#149C4C","font-weight":"700","font-size":"16px"}},[e._v(e._s(t[0]))])])]),e._v(" "),o("el-col",{attrs:{span:14}},[o("div",{staticClass:"grid-content bg-purple-light"},[o("el-table",{staticStyle:{width:"100%"},attrs:{data:t[1]}},[o("el-table-column",{attrs:{prop:"ip",label:"运行主机",sytle:"width: 50%"}}),e._v(" "),o("el-table-column",{attrs:{prop:"env",label:"主机环境",sytle:"width: 50%"}})],1)],1)])],1)],1)})],2),e._v(" "),o("el-card",{staticClass:"box-card",staticStyle:{width:"100%"}},[o("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[o("span",{staticStyle:{color:"#149C4C","font-weight":"700","font-size":"16px"}},[e._v("\n            上传文件\n          ")])]),e._v(" "),o("div",[o("el-form",{ref:"uploadForm",attrs:{model:e.uploadForm,"label-width":"140px",rules:e.uploadForms}},[o("el-form-item",{attrs:{label:"文件名称",prop:"name"}},[o("el-upload",{staticClass:"upload-demo",attrs:{action:e.filePath,"http-request":e.myUpload,"on-change":e.handleChange,"before-remove":e.beforeRemove}},[o("el-button",{attrs:{size:"small",type:"primary"}},[e._v("点击上传")])],1)],1),e._v(" "),o("el-form-item",{attrs:{label:"同步主机",prop:"type"}},[o("el-checkbox-group",{model:{value:e.uploadForm.host,callback:function(t){e.$set(e.uploadForm,"host",t)},expression:"uploadForm.host"}},[o("el-checkbox",{attrs:{label:"lan_dns主机组",name:"host"}}),e._v(" "),o("el-checkbox",{attrs:{label:"wan_dns主机组",name:"host"}})],1)],1),e._v(" "),o("el-form-item",[o("el-button",{attrs:{type:"primary"},on:{click:function(t){e.submitUload("updateForm")}}},[e._v("立即同步")]),e._v(" "),o("el-button",{on:{click:function(t){e.resetRecode("updateForm")}}},[e._v("重置")])],1)],1)],1)]),e._v(" "),o("el-card",{staticClass:"box-card",staticStyle:{width:"100%"}},[o("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[o("span",{staticStyle:{color:"#149C4C","font-weight":"700","font-size":"16px"}},[e._v("\n            新建文件\n          ")])]),e._v(" "),o("div",[o("el-form",{ref:"ruleForm",attrs:{model:e.ruleForm,"label-width":"140px",rules:e.ruleForms}},[o("el-form-item",{attrs:{label:"文件名称",prop:"name"}},[o("el-input",{attrs:{placeholder:"请输入zone文件名称如：xxx.mmm.zone"},on:{blur:function(t){e.isExist(e.ruleForm.name)}},model:{value:e.ruleForm.name,callback:function(t){e.$set(e.ruleForm,"name","string"==typeof t?t.trim():t)},expression:"ruleForm.name"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"同步主机",prop:"type"}},[o("el-checkbox-group",{model:{value:e.ruleForm.host,callback:function(t){e.$set(e.ruleForm,"host",t)},expression:"ruleForm.host"}},[o("el-checkbox",{attrs:{label:"lan_dns主机组",name:"host"}}),e._v(" "),o("el-checkbox",{attrs:{label:"wan_dns主机组",name:"host"}})],1)],1),e._v(" "),o("el-form-item",[o("el-button",{attrs:{type:"primary"},on:{click:function(t){e.submitForm("ruleForm")}}},[e._v("立即创建")]),e._v(" "),o("el-button",{on:{click:function(t){e.resetRecode("ruleForm")}}},[e._v("重置")])],1)],1)],1)]),e._v(" "),o("el-card",{staticClass:"box-card",staticStyle:{width:"100%"}},[o("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[o("span",{staticStyle:{color:"#149C4C","font-weight":"700","font-size":"16px"}},[e._v("\n            删除文件\n          ")])]),e._v(" "),o("div",[o("el-form",{ref:"delForm",attrs:{model:e.delForm,"label-width":"140px",rules:e.delForms}},[o("el-form-item",{attrs:{label:"文件名称",prop:"name"}},[o("el-select",{attrs:{placeholder:"请选择项文件"},on:{change:function(t){e.hanldFile(e.delForm.name)}},model:{value:e.delForm.name,callback:function(t){e.$set(e.delForm,"name",t)},expression:"delForm.name"}},e._l(e.res_data,function(e){return o("el-option",{attrs:{lable:e[0],value:e[0]}})}))],1),e._v(" "),o("el-form-item",{attrs:{label:"同步主机",prop:"type"}},[o("el-checkbox-group",{model:{value:e.delForm.host,callback:function(t){e.$set(e.delForm,"host",t)},expression:"delForm.host"}},[0===e.isLan?o("el-checkbox",{attrs:{label:"lan_dns主机组",name:"host"}}):e._e(),e._v(" "),0===e.isWan?o("el-checkbox",{attrs:{label:"wan_dns主机组",name:"host"}}):e._e()],1)],1),e._v(" "),o("el-form-item",[o("el-button",{attrs:{type:"primary"},on:{click:function(t){e.submitDel("delForm")}}},[e._v("立即删除")]),e._v(" "),o("el-button",{on:{click:function(t){e.resetRecode("delForm")}}},[e._v("重置")])],1)],1)],1)]),e._v(" "),o("el-card",{staticClass:"box-card",staticStyle:{width:"100%"}},[o("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[o("span",{staticStyle:{color:"#149C4C","font-weight":"700","font-size":"16px"}},[e._v("\n            同步文件\n          ")])]),e._v(" "),o("div",[o("el-form",{ref:"syncForm",attrs:{model:e.syncForm,"label-width":"90px",rules:e.syncForms}},[o("el-row",[o("el-col",{attrs:{span:12}},[o("el-form-item",{attrs:{label:"文件名称",prop:"name"}},[o("el-select",{attrs:{placeholder:"请选择同步文件"},model:{value:e.syncForm.name,callback:function(t){e.$set(e.syncForm,"name",t)},expression:"syncForm.name"}},e._l(e.res_data,function(e){return o("el-option",{attrs:{lable:e[0],value:e[0]}})}))],1)],1),e._v(" "),o("el-col",{attrs:{span:12}},[o("el-form-item",{attrs:{label:"同步到 =>>",prop:"type"}},[o("el-checkbox-group",{model:{value:e.syncForm.host,callback:function(t){e.$set(e.syncForm,"host",t)},expression:"syncForm.host"}},[o("el-checkbox",{attrs:{label:"lan_dns主机组",name:"host"}}),e._v(" "),o("el-checkbox",{attrs:{label:"wan_dns主机组",name:"host"}})],1)],1)],1)],1),e._v(" "),o("el-form-item",[o("el-button",{attrs:{type:"primary"},on:{click:function(t){e.submitSync("syncForm")}}},[e._v("立即同步")]),e._v(" "),o("el-button",{on:{click:function(t){e.resetRecode("syncForm")}}},[e._v("重置")])],1)],1)],1)])],1),e._v(" "),o("el-dialog",{attrs:{title:"提示",visible:e.dialogVisible,width:"30%"},on:{"update:visible":function(t){e.dialogVisible=t}}},[o("span",[e._v(e._s(e.files))]),e._v(" "),o("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),e._v(" "),o("el-button",{attrs:{type:"primary"},on:{click:function(t){e.dialogVisible=!1}}},[e._v("确 定")])],1)]),e._v(" "),o("el-dialog",{attrs:{title:"警告",visible:e.outerVisible},on:{"update:visible":function(t){e.outerVisible=t}}},[o("span",{staticStyle:{color:"#149C4C","font-weight":"700","font-size":"16px"}},[e._v("\n              "+e._s(e.permissionMsg)+"\n      ")]),e._v(" "),o("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{on:{click:function(t){e.outerVisible=!1}}},[e._v("取 消")]),e._v(" "),o("el-button",{attrs:{type:"primary"},on:{click:e.toMyself}},[e._v("去申请")])],1)])],1)},staticRenderFns:[]}},390:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={data:function(){return{fileList:[],filePath:this.upload_api,outerVisible:!1,permissionMsg:"",activeNames:["1"],dialogVisible:!1,files:"",formLabelWidth:"108px",editableTabsValue:"2",ruleForm:{name:"",host:[]},uploadForm:{name:"",host:[]},delForm:{id:"",name:"",host:[]},syncForm:{name:"",host:[],isExist:""},res_data:"",isLan:1,isWan:1,one_row:{file_name:"",type:"",host:"",value:""},test_vue:{"huashenghaoche.com.zone":["huashenghaoche.com.zone",[{ip:"172.30.5.135",env:"wan_dns主机组"},{ip:"172.30.5.145",env:"wan_dns主机组"},{ip:"192.168.99.252",env:"lan_dns主机组"},{ip:"192.168.99.251",env:"lan_dns主机组"}],1]},ruleForms:{name:[{required:!0,message:"文件名称不能为空",trigger:"blur"}],host:[{type:"array",required:!0,message:"请至少选择一个主机组",trigger:"change"}]},delForms:{name:[{required:!0,message:"文件名称不能为空",trigger:"blur"}],host:[{type:"array",required:!0,message:"请至少选择一个主机组",trigger:"change"}]},syncForms:{name:[{required:!0,message:"文件名称不能为空",trigger:"blur"}],host:[{type:"array",required:!0,message:"请至少选择一个主机组",trigger:"change"}]},uploadForms:{name:[{required:!0,message:"文件名称不能为空",trigger:"blur"}],host:[{type:"array",required:!0,message:"请至少选择一个主机组",trigger:"change"}]}}},activated:function(){this.get_all_list()},methods:{get_all_list:function(){var e=this;console.log("this is get_all_list"),this.$http.get(this.dns_api+"file_list").then(function(t){e.res_data=t.data.data}).catch(function(t){e.res_data="error"})},permissionControl:function(e){if("21"===e.data.code){window.localStorage.setItem("permission",e.data.data),this.permissionMsg=e.data.msg,this.outerVisible=!0;var t=window.localStorage.getItem("permission");console.log(t)}},toMyself:function(){this.outerVisible=!this.outerVisible,window.location="/myself"},isExist:function(e){var t=void 0;for(t in this.res_data)e===t&&(this.ruleForm.name="",this.files=e+" is exist..",this.dialogVisible=!0)},hanldFile:function(e){console.log("hanldFile",e),this.isLan=1,this.isWan=1;var t=void 0,o=void 0;for(t in this.res_data)if(t===e){this.delForm.id=this.res_data[t][2];for(o in this.res_data[t][1])"lan_dns主机组"===this.res_data[t][1][o].env?this.isLan=0:"wan_dns主机组"===this.res_data[t][1][o].env&&(this.isWan=0)}},myUpload:function(e){this.uploadForm.name=e.file.name,this.$http.post(this.upload_api,e.file).then(function(t){e.onSuccess("配时文件上传成功")}).catch(function(e){console.log(e)})},beforeRemove:function(e,t){return console.log("beforeRemove"),this.$confirm("确定移除")},handlePreview:function(e){console.log("handlePreview"),console.log(e,this.fileList)},handleChange:function(e,t){console.log("handleChange"),console.log(e,this.fileList)},handleRemove:function(e){console.log("handleRemove"),console.log(e,this.fileList)},submitUload:function(){var e=this;console.log("submitUload",this.uploadForm),this.$http.post(this.dns_api+"upload_file/",this.uploadForm).then(function(t){e.permissionControl(t),console.log("resp",t),t.data.status?(e.$notify({title:"成功",message:"创建成功",type:"success"}),e.get_all_list(),e.uploadForm.host=[],e.uploadForm.name=""):console.log(t.data.status+t.data.message)}).catch(function(t){console.log(t),e.$notify.error({title:"错误",message:"创建失败"})})},submitForm:function(e){var t=this;console.log("forms",this.ruleForm),this.$refs[e].validate(function(e){return!!e&&void t.$http.post(t.dns_api+"add_file/",t.ruleForm).then(function(e){t.permissionControl(e),console.log("resp",e),e.data.status?(t.$notify({title:"成功",message:"创建成功",type:"success"}),t.get_all_list(),t.ruleForm.host=[],t.ruleForm.name=""):console.log(e.data.status+e.data.message)}).catch(function(e){console.log("resp",e),t.$notify.error({title:"错误",message:"创建失败"})})})},submitDel:function(e){var t=this;console.log("delforms",this.delForm),this.$refs[e].validate(function(e){return!!e&&void t.$http.post(t.dns_api+"del_file/",t.delForm).then(function(e){t.permissionControl(e),console.log("resp",e),e.data.status?(t.$notify({title:"删除",message:"删除成功",type:"success"}),t.get_all_list(),t.delForm.host=[],t.delForm.name="",t.delForm.id="",t.isLan=1,t.isWan=1):console.log(e.data.status+e.data.message)}).catch(function(e){t.$notify({title:"删除",message:"删除失败",type:"success"}),console.log(e)})})},submitSync:function(e){var t=this;console.log("forms",this.syncForm),this.$refs[e].validate(function(e){return!!e&&void t.$http.post(t.dns_api+"copy_file/",t.syncForm).then(function(e){t.permissionControl(e),console.log("resp",e),e.data.status?(t.$notify({title:"成功",message:"同步成功",type:"success"}),t.get_all_list(),t.syncForm.host=[],t.syncForm.name=""):console.log(e.data.status+e.data.message)}).catch(function(e){console.log("resp",e),t.$notify.error({title:"错误",message:"同步失败"})})})},resetRecode:function(e){this.$refs[e].resetFields()}}}}});
//# sourceMappingURL=3.f9d964e1b82380a9829b.js.map